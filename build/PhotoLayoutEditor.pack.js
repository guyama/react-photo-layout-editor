!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],t):"object"==typeof exports?exports.PhotoLayoutEditor=t(require("react"),require("react-dom")):e.PhotoLayoutEditor=t(e.React,e.ReactDOM)}(this,function(e,t){return webpackJsonpPhotoLayoutEditor([0],[function(t,n){t.exports=e},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.resamplingImage=t.Canvas=t.makingImage=t.uploader=t.object=t.color=t.number=t.util=void 0;var i=n(78),a=o(i),l=n(79),u=o(l),c=n(29),s=o(c),f=n(80),d=o(f),p=n(81),h=r(p),g=n(82),v=r(g),m=n(83),y=r(m),b=n(84),_=r(b);t.util=a,t.number=u,t.color=d,t.object=s,t.uploader=h.default,t.makingImage=v.default,t.Canvas=y.default,t.resamplingImage=_.default},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INIT_PLE="INIT_PLE",t.SIDE_VISIBLE="SIDE_VISIBLE",t.SIDE_ADD_FILES="SIDE_ADD_FILES",t.SIDE_REMOVE_FILES="SIDE_REMOVE_FILES",t.SIDE_UPDATE_SELECTED="SIDE_UPDATE_SELECTED",t.SIDE_TOGGLE="SIDE_TOGGLE",t.SIDE_UPDATE_PROGRESS="SIDE_UPDATE_PROGRESS",t.GRID_ATTACH_IMAGES="GRID_ATTACH_IMAGES",t.GRID_ATTACH_IMAGE="GRID_ATTACH_IMAGE",t.GRID_ADD_BLOCK="GRID_ADD_BLOCK",t.GRID_REMOVE_BLOCK="GRID_REMOVE_BLOCK",t.GRID_SHUFFLE_BLOCKS="GRID_SHUFFLE_BLOCKS",t.GRID_DUPLICATE_BLOCK="GRID_DUPLICATE_BLOCK",t.GRID_UPDATE_BLOCKS="GRID_UPDATE_BLOCKS",t.GRID_ACTIVE_BLOCK="GRID_ACTIVE_BLOCK",t.GRID_SETTING_UPDATE="GRID_SETTING_UPDATE",t.GRID_CHANGE_COLOR="GRID_CHANGE_COLOR",t.CROPPER_OPEN="CROPPER_OPEN",t.CROPPER_CLOSE="CROPPER_CLOSE"},,function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.types=t.body=t.side=t.cropper=t.core=void 0;var o=n(63),i=r(o),a=n(64),l=r(a),u=n(65),c=r(u),s=n(66),f=r(s),d=n(4),p=r(d);t.core=i,t.cropper=c,t.side=f,t.body=l,t.types=p},,,function(e,n){e.exports=t},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setting={base:{uploadScript:null,uploadParamsConvertFunc:null,updateStoreFunc:null},body:{setting:{width:100,height:100,column:5,outerMargin:10,innerMargin:10,freeMode:!1,bgColor:"rgba(255,255,255,1)"},blockColor:"rgba(211,211,211,1)",grid:[]},side:{files:[],visible:!0}},t.side={files:{},visible:!0,progressPercent:null}},,,,,,,,,,,,,,function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return!(!e||!e.length)}Object.defineProperty(t,"__esModule",{value:!0}),t.isArray=r},,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,u,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),f=r(s),d=n(10),p=n(7),h=n(62),g=r(h),v=n(95),m=r(v),y=n(101),b=r(y);n(106);var _=(u=l=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.store=(0,d.createStore)(m.default),e.api=new b.default(e.store),e}return a(t,e),c(t,[{key:"render",value:function(){var e=this.props;return f.default.createElement(p.Provider,{store:this.store},f.default.createElement(g.default,{parent:{preference:e,api:this.api}}))}}]),t}(f.default.Component),l.displayName="PhotoLayoutEditor",u);t.default=_,e.exports=_},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,u,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),f=r(s),d=n(7),p=n(1),h=r(p),g=n(6),v=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(g),m=n(67),y=r(m),b=n(89),_=r(b),E=(u=l=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.el=null,e}return a(t,e),c(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props;this.checkChangeStore(t,e)}},{key:"componentDidMount",value:function(){var e=this.props;e.dispatch(v.core.init(e.parent.api,e.parent.preference||{side:{},body:{}},this.el))}},{key:"checkChangeStore",value:function(e,t){if(!t.setting.base.updateStoreFunc||"function"!=typeof t.setting.base.updateStoreFunc)return null;e.tree.side.visible===t.tree.side.visible&&e.tree.side.files===t.tree.side.files&&e.tree.body.setting===t.tree.body.setting&&e.tree.body.grid===t.tree.body.grid||t.setting.base.updateStoreFunc()}},{key:"render",value:function(){var e=this,t=this.props;return f.default.createElement("div",{ref:function(t){e.el=t},className:(0,h.default)("ple-editor",{"ple-side-active":t.tree.side.visible})},t.setting&&f.default.createElement("div",{className:"ple-wrap"},f.default.createElement(y.default,null),f.default.createElement(_.default,null)))}}]),t}(f.default.Component),l.displayName="Container",l.defaultProps={parent:{},dispatch:null,tree:{},setting:null},u);t.default=(0,d.connect)(function(e){return Object.assign({},e,{})})(E)},function(e,t,n){"use strict";function r(e,t,n){return{type:i.INIT_PLE,api:e,preference:t,element:n}}Object.defineProperty(t,"__esModule",{value:!0}),t.init=r;var o=n(4),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o)},function(e,t,n){"use strict";function r(e){return{type:h.GRID_ADD_BLOCK,value:e}}function o(e){return{type:h.GRID_REMOVE_BLOCK,keys:e}}function i(e){return{type:h.GRID_SHUFFLE_BLOCKS,value:e}}function a(e){return{type:h.GRID_DUPLICATE_BLOCK,keys:e}}function l(e){return{type:h.GRID_UPDATE_BLOCKS,value:e}}function u(e){return{type:h.GRID_ACTIVE_BLOCK,value:e}}function c(e,t){return{type:h.GRID_CHANGE_COLOR,keys:e,color:t}}function s(e){return{type:h.GRID_SETTING_UPDATE,value:e}}function f(e,t,n){return{type:h.GRID_ATTACH_IMAGES,value:e,columns:t,activeBlocks:n}}function d(e,t){return{type:h.GRID_ATTACH_IMAGE,keys:e,image:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.addBlock=r,t.removeBlock=o,t.shuffleBlocks=i,t.duplicateBlock=a,t.updateBlocks=l,t.activeBlock=u,t.changeColorBlock=c,t.updateSetting=s,t.attachImages=f,t.attachImage=d;var p=n(4),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(p)},function(e,t,n){"use strict";function r(e,t){return{type:a.CROPPER_OPEN,item:t,key:e}}function o(e,t,n){return{type:a.CROPPER_CLOSE,key:e,position:t,size:n}}Object.defineProperty(t,"__esModule",{value:!0}),t.open=r,t.close=o;var i=n(4),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i)},function(e,t,n){"use strict";function r(e){return{type:s.SIDE_VISIBLE,value:e}}function o(){return{type:s.SIDE_TOGGLE}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:s.SIDE_ADD_FILES,files:e}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:s.SIDE_REMOVE_FILES,keys:e}}function l(e){return{type:s.SIDE_UPDATE_SELECTED,value:e}}function u(e){return{type:s.SIDE_UPDATE_PROGRESS,value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.visible=r,t.toggle=o,t.addFiles=i,t.removeFiles=a,t.updateSelected=l,t.updateProgress=u;var c=n(4),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(c)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,u,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),f=r(s),d=n(68),p=r(d),h=n(85),g=r(h),v=(u=l=function(e){function t(e){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return a(t,e),c(t,[{key:"render",value:function(){return f.default.createElement("div",{className:"ple-container"},f.default.createElement("div",{className:"ple-body"},f.default.createElement(g.default,null),f.default.createElement(p.default,null)))}}]),t}(f.default.Component),l.displayName="Body",u);t.default=v},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u,c,s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(0),p=o(d),h=n(7),g=n(69),v=o(g),m=n(1),y=o(m),b=n(76),_=o(b),E=n(6),w=r(E),k=n(2),O=r(k),S=[],P=(c=u=function(e){function t(e){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return l(t,e),f(t,[{key:"_selectBlock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.props;if(null===e)return void t.api.grid.select([]);switch(t.keyboard.keyName){case"CMD":case"CTRL":case"SHIFT":if(O.object.isArray(t.tree.body.activeBlock)){var n=Object.assign([],t.tree.body.activeBlock);return n.indexOf(e)>-1?n.splice(n.indexOf(e),1):n.push(e),void t.api.grid.select(n)}}t.api.grid.select([e])}},{key:"_updateBlocks",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],this.props);switch(e){case"start":S[0]=(new Date).getTime();break;case"end":if(S[1]=(new Date).getTime(),S[1]-S[0]>400){var r=function(){for(var e={},n=0;n<t.length;n++)e[t[n].i.split("__")[1]]=t[n];return e}(),o={};Object.keys(n.tree.body.grid).forEach(function(e){o[e]=s({},n.tree.body.grid[e],{layout:{x:r[e].x,y:r[e].y,w:r[e].w,h:r[e].h}})}),n.dispatch(w.body.updateBlocks(o))}S=[]}}},{key:"renderItem",value:function(e){var t=this,n=this.props,r=n.tree.body,o=r.activeBlock,i=r.grid,a=i[e],l=a.indexPrefix+"__"+e,u=!!(o&&o.length&&o.indexOf(e)>-1);return p.default.createElement("div",{key:l,"data-grid":a.layout,"data-key":e,onClick:function(n){n.stopPropagation(),t._selectBlock(e,!!a.image)},style:{backgroundColor:a.color||n.setting.body.blockColor},className:(0,y.default)({"ple-grid__item-active":u})},a.image&&p.default.createElement("figure",{style:{backgroundImage:"url('"+a.image.src+"')",backgroundPosition:a.image.position,backgroundSize:a.image.size}}))}},{key:"render",value:function(){var e=this,t=this.props,n=t.tree.body.setting,r=n.width*n.column+n.innerMargin*(n.column-1)+2*n.outerMargin;return p.default.createElement("div",{className:"ple-grid__wrap",onClick:function(){return e._selectBlock()}},p.default.createElement("div",{className:"ple-grid__body",style:{width:r+"px"}},p.default.createElement(v.default,{autoSize:!0,cols:n.column,rowHeight:n.height,width:r,margin:[n.innerMargin,n.innerMargin],containerPadding:[n.outerMargin,n.outerMargin],verticalCompact:!n.freeMode,onDragStart:function(){return e._updateBlocks("start")},onDragStop:function(t,n,r,o,i,a){return e._updateBlocks("end",t,a)},onResizeStart:function(){return e._updateBlocks("start")},onResizeStop:function(t,n,r,o,i,a){return e._updateBlocks("end",t,a)},style:{width:"100%",backgroundColor:n.bgColor},className:"ple-grid"},Object.keys(t.tree.body.grid).map(function(t){return e.renderItem(t)})),t.tree.cropper.visible?p.default.createElement(_.default,null):null))}}]),t}(p.default.Component),u.displayName="GridLayout",u.defaultProps={tree:null,dispatch:null},c);t.default=(0,h.connect)(function(e){return Object.assign({},e,{})})(P)},,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,u,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),f=r(s),d=n(7),p=n(5),h=r(p),g=n(1),v=r(g),m=n(77),y=r(m),b=n(2),_=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(b),E=(u=l=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=e.tree.cropper;return n.imageMeta=null,n._block=null,n.$item=(0,h.default)(e.element).find(".react-grid-item").filter("[data-key="+r.key+"]"),n.state={pending:!0,position:r.item.image.position,size:r.item.image.size||"cover",width:n.$item.width(),height:n.$item.height(),top:n.$item.position().top,left:n.$item.position().left},n}return a(t,e),c(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.tree.cropper;_.util.getImageSize(n.item.image.src).then(function(t){e.imageMeta=t,e.setState({pending:!1})})}},{key:"_onClose",value:function(){var e=this.props;e.api.cropper.close(e.tree.cropper.key,this._block.state.position,this._block.state.size)}},{key:"_toggleImageType",value:function(){var e=this.state;if(this.props,"cover"===e.size){var t="",n=0;e.height>e.width?(n=_.number.getRatioForResize(e.height,this.imageMeta.height),t=parseInt(this.imageMeta.width*n)+"px "+e.height+"px"):(n=_.number.getRatioForResize(e.width,this.imageMeta.width),t=e.width+"px "+parseInt(this.imageMeta.height*n)+"px"),this.setState({position:"0 0",size:t})}else this.setState({position:"50% 50%",size:"cover"})}},{key:"render",value:function(){var e=this,t=this.state,n=this.props;return t.pending?null:f.default.createElement("div",{className:"ple-cropper"},f.default.createElement("span",{className:"ple-cropper__bg"}),f.default.createElement("div",{style:{width:t.width+"px",height:t.height+"px",top:t.top+"px",left:t.left+"px"},className:"ple-cropper__wrap"},f.default.createElement(y.default,{ref:function(t){e._block=t},src:n.tree.cropper.item.image.src,position:t.position,size:t.size,bgColor:n.tree.cropper.item.color||n.setting.body.blockColor}),f.default.createElement("nav",{className:"ple-cropper__nav"},f.default.createElement("button",{type:"button",onClick:function(){return e._onClose()}},f.default.createElement("i",{className:"ple-sp-ico ple-ico-close ple-abs"},"Close cropper")),f.default.createElement("button",{type:"button",onClick:function(){return e._toggleImageType()},className:(0,v.default)({"ple-cropper__nav-active":"cover"!==t.size})},f.default.createElement("i",{className:"ple-sp-ico ple-ico-resize ple-abs"},"Toggle background size type")))))}}]),t}(f.default.Component),l.displayName="Cropper",u);t.default=(0,d.connect)(function(e){return Object.assign({},e,{})})(E)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,u,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),f=r(s),d=n(9),p=r(d),h=n(5),g=r(h),v=n(1),m=r(v),y=n(2),b={start:y.util.isTouchDevice()?"touchstart":"mousedown",move:y.util.isTouchDevice()?"touchmove":"mousemove",end:y.util.isTouchDevice()?"touchend":"mouseup"},_=(u=l=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={position:e.position,size:e.size,isCover:"cover"===e.size},n._self=null,n.$self=null,n.$img=null,n.moveStartInfo={},n.resizeStartInfo={},n}return a(t,e),c(t,[{key:"componentDidMount",value:function(){this.$self=(0,g.default)(p.default.findDOMNode(this._self))}},{key:"componentWillReceiveProps",value:function(e){this.props.size!==e.size&&this.setState({position:e.position,size:e.size,isCover:"cover"===e.size})}},{key:"_moveStart",value:function(e){var t=this;e.stopPropagation();var n=this.state;this.$img=this.$self.find("img"),this.moveStartInfo={containerX:parseInt(n.position.split(" ")[0]),containerY:parseInt(n.position.split(" ")[1]),mouseX:(e.clientX||e.pageX||e.nativeEvent.touches[0].clientX)+(0,g.default)(window).scrollLeft(),mouseY:(e.clientY||e.pageY||e.nativeEvent.touches[0].clientY)+(0,g.default)(window).scrollTop()},(0,g.default)(document).on(b.move+".move",function(e){return t._moveIng(e)}).on(b.end+".move",function(e){return t._moveEnd(e)})}},{key:"_moveIng",value:function(e){e.stopPropagation();var t="touchmove"===e.type?e.originalEvent.touches[0]:e,n={},r={};n.x=(t.clientX||t.pageX)+(0,g.default)(window).scrollLeft(),n.y=(t.clientY||t.pageY)+(0,g.default)(window).scrollTop(),r.x=this.moveStartInfo.containerX+(n.x-this.moveStartInfo.mouseX),r.y=this.moveStartInfo.containerY+(n.y-this.moveStartInfo.mouseY),this.setState({position:parseInt(r.x)+"px "+parseInt(r.y)+"px"})}},{key:"_moveEnd",value:function(e){e.preventDefault(),this.$img=null,this.moveStartInfo=null,(0,g.default)(document).off(b.move+".move").off(b.end+".move")}},{key:"_resizeStart",value:function(e){var t=this;e.stopPropagation();var n=this.state;this.$img=this.$self.find("img"),this.resizeStartInfo={title:e.currentTarget.title,width:this.$img.width(),height:this.$img.height(),mouseX:(e.clientX||e.pageX||e.nativeEvent.touches[0].clientX)+(0,g.default)(window).scrollLeft(),posX:parseInt(n.position.split(" ")[0]),posY:parseInt(n.position.split(" ")[1])},(0,g.default)(document).on(b.move+".resize",function(e){return t._resizeIng(e)}).on(b.end+".resize",function(e){return t._resizeEnd(e)})}},{key:"_resizeIng",value:function(e){e.stopPropagation();var t={},n={},r=1,o=0,i="touchmove"===e.type?e.originalEvent.touches[0]:e,a=(i.clientX||i.pageX)+(0,g.default)(window).scrollLeft()-this.resizeStartInfo.mouseX;switch(this.resizeStartInfo.title){case"resize-lt":n.x=this.resizeStartInfo.posX+a,t.width=this.resizeStartInfo.width-a,r=t.width/this.$img.get(0).naturalWidth,t.height=parseInt(this.$img.get(0).naturalHeight*r),o=this.resizeStartInfo.height-t.height,n.y=this.resizeStartInfo.posY+o;break;case"resize-rt":n.x=this.resizeStartInfo.posX,t.width=this.resizeStartInfo.width+a,r=t.width/this.$img.get(0).naturalWidth,t.height=parseInt(this.$img.get(0).naturalHeight*r),o=this.resizeStartInfo.height-t.height,n.y=this.resizeStartInfo.posY+o;break;case"resize-lb":n.x=this.resizeStartInfo.posX+a,n.y=this.resizeStartInfo.posY,t.width=this.resizeStartInfo.width-a,r=t.width/this.$img.get(0).naturalWidth,t.height=parseInt(this.$img.get(0).naturalHeight*r);break;case"resize-rb":n.x=this.resizeStartInfo.posX,n.y=this.resizeStartInfo.posY,t.width=this.resizeStartInfo.width+a,r=t.width/this.$img.get(0).naturalWidth,t.height=parseInt(this.$img.get(0).naturalHeight*r);break;default:return}this.setState({size:parseInt(t.width)+"px "+parseInt(t.height)+"px",position:parseInt(n.x)+"px "+parseInt(n.y)+"px"})}},{key:"_resizeEnd",value:function(e){this.$img=null,this.resizeStartInfo=null,(0,g.default)(document).off(b.move+".resize").off(b.end+".resize")}},{key:"render",value:function(){var e=this,t=this.state,n=this.props,r="cover"!==t.size?t.size.split(" "):t.size,o=t.position.split(" ");return f.default.createElement("figure",{ref:function(t){e._self=t},style:{backgroundColor:n.bgColor},className:"ple-cropperBlock ple-cropper__block"},t.isCover?f.default.createElement("span",{style:{backgroundImage:"url('"+n.src+"')"},className:"ple-cropperBlock__image ple-cropperBlock__image-cover"}):f.default.createElement("span",{className:(0,m.default)("ple-cropperBlock__image",{"ple-cropperBlock__image-resize":"cover"!==n.size})},f.default.createElement("img",{src:n.src,style:Object.assign({},"cover"!==t.size&&{width:r[0],transform:"translate("+o[0]+", "+o[1]+")"}),alt:"image"})),f.default.createElement("div",{onMouseDown:function(t){return e._moveStart(t)},onTouchStart:function(t){return e._moveStart(t)},style:Object.assign({},"cover"!==t.size&&{width:r[0],height:r[1],transform:"translate("+o[0]+", "+o[1]+")"}),className:(0,m.default)("ple-cropperBlock__control",{"ple-cropperBlock__control-active":"cover"!==n.size})},f.default.createElement("button",{type:"button",title:"resize-lt",onMouseDown:function(t){return e._resizeStart(t)},onTouchStart:function(t){return e._resizeStart(t)},className:"ple-cropperBlock__resize ple-cropperBlock__resize-lt"},f.default.createElement("i",{className:"ple-sp-ico ple-abs ple-ico-clamp"})),f.default.createElement("button",{type:"button",title:"resize-rt",onMouseDown:function(t){return e._resizeStart(t)},onTouchStart:function(t){return e._resizeStart(t)},className:"ple-cropperBlock__resize ple-cropperBlock__resize-rt"},f.default.createElement("i",{className:"ple-sp-ico ple-abs ple-ico-clamp"})),f.default.createElement("button",{type:"button",title:"resize-lb",onMouseDown:function(t){return e._resizeStart(t)},onTouchStart:function(t){return e._resizeStart(t)},className:"ple-cropperBlock__resize ple-cropperBlock__resize-lb"},f.default.createElement("i",{className:"ple-sp-ico ple-abs ple-ico-clamp"})),f.default.createElement("button",{type:"button",title:"resize-rb",onMouseDown:function(t){return e._resizeStart(t)},onTouchStart:function(t){return e._resizeStart(t)},className:"ple-cropperBlock__resize ple-cropperBlock__resize-rb"},f.default.createElement("i",{className:"ple-sp-ico ple-abs ple-ico-clamp"}))))}}]),t}(f.default.Component),l.displayName="Block",l.defaultProps={src:"",position:"",size:"",bgColor:"#fff"},u);t.default=_},function(e,t,n){"use strict";function r(){return"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"pleTimer";return new Promise(function(n){window[t]=setTimeout(n,e)})}function i(e){return new Promise(function(t,n){e&&"string"==typeof e||n();var r=document.createElement("img");r.onload=function(){t({width:r.naturalWidth,height:r.naturalHeight,ratio:r.naturalHeight/r.naturalWidth})},r.onerror=function(){n()},r.src=e})}function a(e,t){if(CSS&&CSS.supports)return CSS.supports(e,t)}function l(e){return new Promise(function(t){if(e){var n=new Image;n.onload=function(e){t(n)},n.onError=function(e){t(null)},n.setAttribute("crossOrigin","anonymous"),n.src=e}else t(null)})}Object.defineProperty(t,"__esModule",{value:!0}),t.isTouchDevice=r,t.sleep=o,t.getImageSize=i,t.checkSupportCss=a,t.loadImage=l,t.cssPrefix=function(){var e=window.getComputedStyle(document.documentElement,""),t=(Array.prototype.slice.call(e).join("").match(/-(moz|webkit|ms)-/)||""===e.OLink&&["","o"])[1];return{dom:"WebKit|Moz|MS|O".match(new RegExp("("+t+")","i"))[1],lowercase:t,css:"-"+t+"-",js:t[0].toUpperCase()+t.substr(1)}}()},function(e,t,n){"use strict";function r(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?Math.random()*(t-e)+e:Math.floor(Math.random()*(t-e+1))+e}function o(e,t){return t>e?e/t:t/e}function i(){return Math.round(+new Date/1e3)}function a(e,t){var n=parseInt(e)/parseInt(t);return n=Math.round(1e3*n)/1e3}Object.defineProperty(t,"__esModule",{value:!0}),t.randomRange=r,t.getRatioForResize=o,t.getTimeStamp=i,t.getRatio=a},function(e,t,n){"use strict";function r(e){return e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),e&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""}Object.defineProperty(t,"__esModule",{value:!0}),t.rgbToHex=r},function(e,t,n){"use strict";function r(e){var t=u.default.Deferred(),n=new FileReader;return n.addEventListener("load",function(n){t.resolve({name:e.name,type:e.type,size:e.size,url:n.target.result})}),n.addEventListener("error",function(e){t.reject(e.target)}),n.readAsDataURL(e),t.promise()}function o(e,t){function n(e){try{var t=JSON.parse(e.target.responseText);if("success"!==t.state)throw"server error";o.resolve(t.data)}catch(e){o.reject(e)}}function r(e){var t=e.loaded,n=e.total;o.notify("progress",t,n)}var o=u.default.Deferred(),i=new XMLHttpRequest;if("function"!=typeof FormData&&"object"!==("undefined"==typeof FormData?"undefined":a(FormData)))return o.reject("not support browser",t),null;var l=new FormData;return l.append("files[]",t),i.open("post",e,!0),i.addEventListener("load",n),i.upload.addEventListener("progress",r),i.send(l),o.notify("start"),o.promise()}function i(e,t){function n(){if(l>=a)return void i.resolve();t?o(t,e[l]).done(function(e){i.notify("done",{count:l,data:e}),l++,n()}).progress(function(e,t,n){i.notify(e,"progress"===e&&{loaded:t,total:n})}).fail(function(e){i.reject(e)}):r(e[l]).done(function(e){i.notify("done",{count:l,data:e}),l++,n()}).fail(function(){})}var i=u.default.Deferred(),a=e.length,l=0;return n(0),i.promise()}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=i;var l=n(5),u=function(e){return e&&e.__esModule?e:{default:e}}(l)},function(e,t,n){"use strict";function r(e,t,n,r,o){var i={width:0,height:0};switch(e){case"cover":t>n?(i.width=t,i.height=o*(t/r),n>i.height&&(i.width=r*(n/o),i.height=n)):(i.width=r*(n/o),i.height=n,t>i.width&&(i.width=t,i.height=o*(t/r)));break;case"width":i.width=t,i.height=o*(t/r);break;case"height":i.width=r*(n/o),i.height=n;break;default:i.width=t,i.height=n}return{width:Math.round(i.width),height:Math.round(i.height)}}function o(e,t){if(!e||!t)return null;var n=(0,s.default)(e).children(),r=[];return n.each(function(e,n){var o=(0,s.default)(n),i=t[o.data("key")],a=i.image;a&&(a={src:a.src,position:a.position.split(" "),size:"cover"===a.size?null:a.size.split(" ")}),r.push({x:o.position().left,y:o.position().top,width:o.width(),height:o.height(),image:a||null,color:i.color||"rgba(255,255,255,1)"})}),r}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n){d.util.loadImage(e.image?e.image.src:null).then(function(o){if(o){var i={width:o.naturalWidth,height:o.naturalHeight},a={},l={};e.image.size?(a=r("width",parseInt(e.image.size[0]),0,i.width,i.height),l.x=parseInt(e.image.position[0]),l.y=parseInt(e.image.position[1])):(a=r("cover",e.width,e.height,i.width,i.height),l.x=.5*e.width-.5*a.width,l.y=.5*e.height-.5*a.height),d.resamplingImage({image:o,reSampleCount:t.sampling,width:e.width,height:e.height,cx:0,cy:0,cw:i.width,ch:i.height,dx:l.x,dy:l.y,dw:a.width,dh:a.height,bgColor:e.color}).then(function(t){n({width:e.width,height:e.height,x:e.x,y:e.y,image:t})})}else n({width:e.width,height:e.height,x:e.x,y:e.y,color:e.color,image:new d.Canvas(e.width,e.height,e.color)})})})}function a(e,t){return new Promise(function(n){e.ctx.drawImage(t.image.el,t.x,t.y,t.width,t.height),n(t.image.el)})}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.75;switch(t){case"png":t="image/png";break;case"jpg":default:t="image/jpeg"}return e.toDataURL(t,"image/jpeg"===t?n:void 0)}function u(e){function t(e){return new Promise(function(t,n){i(e,f).then(function(e){a(m,e).then(t,n)},n)})}function n(e){h.splice(0,1),p.notify(v,g++,e),h.length?t(h[0]).then(n,r):u()}function r(e){p.reject(e)}function u(){switch(f.output){case"base64":p.resolve(l(m.el,f.format,f.quality));break;case"canvas":default:p.resolve(m.el)}}var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},p=s.default.Deferred(),h=o(e,c.grid),g=0,v=h.length,m=new d.Canvas(e.offsetWidth,e.offsetHeight,c.setting.bgColor);return p.notify(v,g++,null),h.length?t(h[0]).then(n,r):r("not found queue"),p.promise()}Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;var c=n(5),s=function(e){return e&&e.__esModule?e:{default:e}}(c),f=n(2),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(f)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:150,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#ffffff";r(this,e),this.el=document.createElement("canvas"),this.ctx=this.el.getContext("2d"),this.el.width=t,this.el.height=n,this.ctx.fillStyle=o,this.ctx.fillRect(0,0,t,n)};t.default=o},function(e,t,n){"use strict";function r(e,t,n){return new Promise(function(r){function o(t,n){var i=Math.pow(2,t),l=new a.Canvas(e.width*i,e.height*i,e.bgColor);l.ctx.drawImage(n.el,0,0,.5*n.el.width,.5*n.el.height),t>0?o(t-1,l):r(l)}o(t-1,n)})}function o(e){return e=Object.assign({},l,e),new Promise(function(t,n){e.image||n("not found image"),e.reSampleCount=Math.min(4,e.reSampleCount),e.reSampleCount=Math.max(0,e.reSampleCount);var o=Math.pow(2,e.reSampleCount),i=new a.Canvas(e.width*o,e.height*o,e.bgColor);i.ctx.drawImage(e.image,e.cx,e.cy,e.cw,e.ch,e.dx*o,e.dy*o,e.dw*o,e.dh*o),e.reSampleCount>0?r(e,e.reSampleCount,i).then(t):t(i)})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=n(2),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),l={image:null,width:100,height:100,reSampleCount:1,bgColor:"rgba(255,255,255,1)",cw:0,ch:0,cx:0,cy:0,dw:0,dh:0,dx:0,dy:0}},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c,s,f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=n(0),g=o(h),v=n(1),m=o(v),y=n(7),b=n(5),_=o(b),E=n(30),w=o(E),k=n(6),O=r(k),S=n(2),P=r(S),C=n(87),I=o(C),j=n(88),T=o(j),M=(s=c=function(e){function t(e){a(this,t);var n=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={active:{setting:!1,editBlockColor:!1},visible:{setting:!0,shuffle:!0,add:!0,select:!0,edit:!1,removeImage:!1,duplicate:!1,removeBlock:!1,editColor:!1}},n}return u(t,e),p(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.state,n=this.props,r=Object.assign({},t),o=!1;if(n.tree.body.activeBlock.length!==e.tree.body.activeBlock.length){var i=!!e.tree.body.activeBlock.length;r.visible=Object.assign({},r.visible,{edit:!1,removeImage:!1,duplicate:i,removeBlock:i,editColor:i}),o=!0}if(e.tree.body.activeBlock[0]){var a=!1;e.tree.body.activeBlock.some(function(t){if(e.tree.body.grid[t].image)return a=!0,!0});var l=e.tree.body.grid[e.tree.body.activeBlock[0]];r.visible=Object.assign({},r.visible,{removeImage:a,edit:!(!l||!l.image)}),o=!0}o&&this.setState(r)}},{key:"changeActive",value:function(e,t,n){var r=this,o=this.state,a=t||!o.active[e],l=n?n.currentTarget:null;a?(0,_.default)(document).on("click.pleToolbar",function(t){(0,_.default)(t.target).closest(".ple-toolbar__pop").length||t.target!==l&&t.target.parentNode!==l&&r.changeActive(e,!1)}):(0,_.default)(document).off("click.pleToolbar"),this.setState({active:d({},o.active,i({setting:!1,editColor:!1},e,a))})}},{key:"deactivate",value:function(){var e=this;return(0,_.default)(document).off("click.pleToolbar"),new Promise(function(t){e.setState({active:{setting:!1,editColor:!1}},t)})}},{key:"submitEditSetting",value:function(e){return this.props.dispatch(O.body.updateSetting(e)),this.changeActive("setting",!1),!1}},{key:"render",value:function(){var e=this,t=this.state,n=this.props,r="#fff";if("object"===f(n.tree.body.grid)&&P.object.isArray(n.tree.body.activeBlock)){var o=n.tree.body.activeBlock[0];r=n.tree.body.grid[o]&&n.tree.body.grid[o].color?n.tree.body.grid[o].color:n.setting.body.blockColor}return g.default.createElement("nav",{className:"ple-toolbar"},g.default.createElement("div",{className:"ple-toolbar__wrap"},t.visible.setting&&g.default.createElement(I.default,{iconClass:"ple-ico-setting",className:(0,m.default)("ple-edit-setting",{"ple-toolbar__block-active":t.active.setting}),onClick:function(n){n.persist(),t.active.setting||e.deactivate().then(function(){e.changeActive("setting",null,n)})},title:"Edit preference"},g.default.createElement(T.default,{submit:function(t){return e.submitEditSetting(t)},setting:n.tree.body.setting,defaultSetting:n.setting.body.setting})),t.visible.shuffle&&g.default.createElement(I.default,{iconClass:"ple-ico-arrow-random",onClick:function(){return n.api.grid.shuffle()},title:"Shuffle block"}),t.visible.add&&g.default.createElement(I.default,{iconClass:"ple-ico-plus",onClick:function(){return n.api.grid.add()},title:"Add block"}),t.visible.select&&g.default.createElement(I.default,{iconClass:"ple-ico-select",onClick:function(){return n.api.grid.toggleSelectAll()},title:"Toggle select block"}),t.visible.edit&&g.default.createElement(I.default,{iconClass:"ple-ico-pencil",className:"ple-toolbar__block-key",onClick:function(){return n.api.cropper.open(n.tree.body.activeBlock[0])},title:"Edit block"}),t.visible.removeImage&&g.default.createElement(I.default,{iconClass:"ple-ico-empty",className:"ple-toolbar__block-key",onClick:function(){return n.api.grid.removeImages(n.tree.body.activeBlock)},title:"Remove image in block"}),t.visible.duplicate&&g.default.createElement(I.default,{iconClass:"ple-ico-duplicate",className:"ple-toolbar__block-key",onClick:function(){if(null===n.tree.body.activeBlock)return void alert("Not found select block");n.dispatch(O.body.duplicateBlock(n.tree.body.activeBlock))},title:"Duplicate block"}),t.visible.removeBlock&&g.default.createElement(I.default,{iconClass:"ple-ico-trash",className:"ple-toolbar__block-key",onClick:function(){if(null===n.tree.body.activeBlock)return void alert("Not found select block");n.api.grid.remove(n.tree.body.activeBlock)},title:"Remove block"}),t.visible.editColor&&g.default.createElement(I.default,{iconClass:"ple-ico-palette",className:(0,m.default)("ple-edit-color","ple-toolbar__block-key",{"ple-toolbar__block-active":t.active.editColor}),onClick:function(n){n.persist(),t.active.editColor||e.deactivate().then(function(){return e.changeActive("editColor",null,n)})},title:"Change color"},g.default.createElement("div",{className:"ple-colorPicker__wrap"},g.default.createElement(w.default,{onChange:function(e){e&&n.dispatch(O.body.changeColorBlock(n.tree.body.activeBlock,e))},color:r,className:"ple-colorPicker__body"})))))}}]),t}(g.default.Component),c.displayName="Toolbar",c.defaultProps={dispatch:null,tree:null},s);t.default=(0,y.connect)(function(e){return Object.assign({},e,{})})(M)},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,u,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),f=r(s),d=n(1),p=r(d),h=(u=l=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),c(t,[{key:"render",value:function(){var e=this.props;return f.default.createElement("div",{className:(0,p.default)("ple-toolbar__block",e.className)},f.default.createElement("button",{type:"button",title:e.title,onClick:e.onClick},f.default.createElement("i",{className:(0,p.default)("ple-sp-ico","ple-abs",e.iconClass)},e.title)),!!e.children&&f.default.createElement("div",{className:"ple-toolbar__pop"},e.children))}}]),t}(f.default.Component),l.displayName="Button",u);t.default=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u,c,s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(0),p=r(d),h=n(5),g=r(h),v=n(30),m=r(v),y=n(1),b=r(y),_=(c=u=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state=s({},e.defaultSetting,e.setting,{popup_bgColor:!1}),n}return l(t,e),f(t,[{key:"componentWillReceiveProps",value:function(){var e=this.props;this.setState(s({},e.defaultSetting,e.setting))}},{key:"activeBgColorPopup",value:function(e,t){var n=this,r=this.state,o=t?t.currentTarget:null;e=e||!r.popup_bgColor,e?(0,g.default)(document).on("click.pleEditBgColor",function(e){(0,g.default)(e.target).closest(".ple-edit-bgColor__popup").length||e.target!==o&&e.target.parentNode!==o&&n.activeBgColorPopup(!1)}):(0,g.default)(document).off("click.pleEditBgColor"),this.setState({popup_bgColor:e})}},{key:"_submit",value:function(e){e.preventDefault(),this.props.submit(this.state)}},{key:"_reset",value:function(){this.setState(s({},this.props.defaultSetting))}},{key:"_change",value:function(e){var t=e.target.value||"";switch(e.target.type){case"text":this.setState(o({},e.target.name,t));break;case"number":t=t||0,this.setState(o({},e.target.name,parseInt(t)))}}},{key:"_openBgColorPicker",value:function(e){e.persist(),this.activeBgColorPopup(null,e)}},{key:"render",value:function(){var e=this,t=this.state;return this.props,p.default.createElement("form",{onSubmit:function(t){return e._submit(t)},className:"ple-edit-setting"},p.default.createElement("fieldset",{className:"ple-edit-setting__form"},p.default.createElement("legend",null,"Settings form"),p.default.createElement("h1",{className:"ple-edit-setting__title"},"Settings"),p.default.createElement("dl",null,p.default.createElement("dt",null,p.default.createElement("label",{htmlFor:"frm_width"},"Width")),p.default.createElement("dd",{className:"ple-type-input"},p.default.createElement("input",{type:"number",name:"width",id:"frm_width",min:1,max:999,maxLength:3,value:t.width,onChange:function(t){return e._change(t)},style:{width:"72px"},required:!0}),p.default.createElement("span",null,"px"))),p.default.createElement("dl",null,p.default.createElement("dt",null,p.default.createElement("label",{htmlFor:"frm_height"},"Height")),p.default.createElement("dd",{className:"ple-type-input"},p.default.createElement("input",{type:"number",name:"height",id:"frm_height",min:1,max:999,value:t.height,onChange:function(t){return e._change(t)},style:{width:"72px"},required:!0}),p.default.createElement("span",null,"px"))),p.default.createElement("dl",null,p.default.createElement("dt",null,p.default.createElement("label",{htmlFor:"frm_column"},"Column")),p.default.createElement("dd",{className:"ple-type-input"},p.default.createElement("input",{type:"number",name:"column",id:"frm_column",min:1,max:99,value:t.column,onChange:function(t){return e._change(t)},style:{width:"54px"},required:!0}),p.default.createElement("span",null,"ea"))),p.default.createElement("dl",{className:"ple-type-input"},p.default.createElement("dt",null,p.default.createElement("label",{htmlFor:"frm_outerMargin"},"Outer margin")),p.default.createElement("dd",null,p.default.createElement("input",{type:"number",name:"outerMargin",id:"frm_outerMargin",min:0,max:500,value:t.outerMargin,onChange:function(t){return e._change(t)},style:{width:"58px"},required:!0}),p.default.createElement("span",null,"px"))),p.default.createElement("dl",{className:"ple-type-input"},p.default.createElement("dt",null,p.default.createElement("label",{htmlFor:"frm_innerMargin"},"Inner margin")),p.default.createElement("dd",null,p.default.createElement("input",{type:"number",name:"innerMargin",id:"frm_innerMargin",min:0,max:500,value:t.innerMargin,onChange:function(t){return e._change(t)},style:{width:"58px"},required:!0}),p.default.createElement("span",null,"px"))),p.default.createElement("dl",null,p.default.createElement("dt",null,p.default.createElement("label",{htmlFor:"frm_bgColor"},"Bg color")),p.default.createElement("dd",null,p.default.createElement("div",{className:"ple-edit-bgColor"},p.default.createElement("span",{className:(0,b.default)("ple-edit-bgColor__inputBox",{"ple-edit-bgColor__inputBox-active":t.popup_bgColor})},p.default.createElement("input",{type:"text",name:"bgColor",id:"frm_bgColor",value:t.bgColor,onChange:function(t){return e._change(t)},onClick:function(t){return e._openBgColorPicker(t)},readOnly:!0,required:!0,className:"ple-edit-bgColor__input",style:{backgroundColor:t.bgColor}})),t.popup_bgColor&&p.default.createElement("div",{className:"ple-edit-bgColor__popup"},p.default.createElement("div",{className:"ple-edit-bgColor__picker"},p.default.createElement(m.default,{onChange:function(t){return e.setState({bgColor:t})},color:t.bgColor})))))),p.default.createElement("dl",null,p.default.createElement("dt",null,p.default.createElement("label",{htmlFor:"frm_freeMode"},"Free mode")),p.default.createElement("dd",{className:"ple-type-checkbox"},p.default.createElement("label",null,p.default.createElement("input",{type:"radio",name:"freeMode",id:"frm_freeMode",onChange:function(){return e.setState({freeMode:!0})},checked:t.freeMode}),p.default.createElement("span",null,"true")),p.default.createElement("label",null,p.default.createElement("input",{type:"radio",name:"freeMode",onChange:function(){return e.setState({freeMode:!1})},checked:!t.freeMode}),p.default.createElement("span",null,"false"))))),p.default.createElement("nav",{className:"ple-edit-setting__buttons"},p.default.createElement("span",null,p.default.createElement("button",{type:"button",onClick:function(){return e._reset()}},"Reset")),p.default.createElement("span",null,p.default.createElement("button",{type:"submit",className:"ple-submit"},"Apply"))))}}]),t}(p.default.Component),u.displayName="EditLayoutSetting",u.defaultProps={submit:function(e){},setting:null,defaultSetting:{width:100,height:100,column:5,outerMargin:10,innerMargin:10,freeMode:!1,bgColor:"rgba(255,255,255,1)"}},c);t.default=_},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u,c,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),d=o(f),p=n(7),h=n(1),g=o(h),v=n(5),m=o(v),y=n(6),b=r(y),_=n(90),E=o(_),w=n(91),k=o(w),O=n(92),S=o(O),P=n(2),C=r(P),I=n(94),j=o(I),T=(c=u=function(e){function t(e){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.dragTarget=null,n.dragPosition=[],n.$gridItems=null,n.$dragItem=null,n.uploading=!1,n}return l(t,e),s(t,[{key:"getGridsterItem",value:function(){var e=this,t=this.props,n=null;return this.$gridItems=(0,m.default)(t.element).find(".ple-grid > div"),this.$gridItems.each(function(t,r){var o=(0,m.default)(r),i=o.offset();if(i.left<e.dragPosition[0]&&i.left+o.width()>e.dragPosition[0]&&i.top<e.dragPosition[1]&&i.top+o.height()>e.dragPosition[1])return n=o.data("key"),!1}),n}},{key:"_selectItem",value:function(e){var t=this.props,n=(0,j.default)(t,e);t.api.side.select(n)}},{key:"_removeItems",value:function(){var e=this.props,t=e.api.side.getKeys("selected");if(t.length)confirm("Do you really want to delete it?")&&e.api.side.remove(t);else{if(!confirm("Delete all?"))return;t=e.api.side.getKeys("all"),e.api.side.remove(t)}}},{key:"_upload",value:function(e){this.props.api.side.upload(e)}},{key:"_attach",value:function(){try{var e=this.props.api.side.getKeys("selected"),t=this.props.api.side.attachToGrid(e);if(t)throw t}catch(e){alert(e.message)}}},{key:"_dragStartItem",value:function(e){var t=this,n=this.props;e.dataTransfer.setData("text/plain",null),this.$gridItems=(0,m.default)(n.element).find(".ple-grid > div"),this.$gridItems.on("dragover",function(e){e.preventDefault(),(0,m.default)(e.currentTarget).hasClass("ple-grid__item-hover")||(0,m.default)(e.currentTarget).addClass("ple-grid__item-hover")}).on("dragleave",function(e){e.preventDefault(),(0,m.default)(e.currentTarget).removeClass("ple-grid__item-hover")}).on("drop",function(e){e.preventDefault(),(0,m.default)(e.currentTarget).removeClass("ple-grid__item-hover"),t.dragTarget=(0,m.default)(e.currentTarget).data("key")})}},{key:"_dragEndItem",value:function(e){var t=this.props;this.$gridItems.off(),this.$gridItems=null,null!==this.dragTarget&&(t.dispatch(b.body.attachImage(this.dragTarget,(0,m.default)(e.currentTarget).data("image"))),this.dragTarget=null)}},{key:"_touchStartItem",value:function(e){this.$dragItem=(0,m.default)(e.currentTarget).clone().removeAttr("draggable").addClass("ple-side__placeholder").width((0,m.default)(e.currentTarget).width()).height((0,m.default)(e.currentTarget).height()),(0,m.default)("body").append(this.$dragItem)}},{key:"_touchMoveItem",value:function(e){C.util.checkSupportCss("touch-action","pan-y")||e.preventDefault();var t=e.nativeEvent.touches[0];this.dragPosition=[t.pageX,t.pageY],this.$dragItem.css({left:t.pageX-.5*this.$dragItem.width(),top:t.pageY-.5*this.$dragItem.height()})}},{key:"_touchEndItem",value:function(e){var t=this.props;if(this.$dragItem.remove(),this.$dragItem=null,this.dragPosition.length>0){if(this.dragTarget=this.getGridsterItem(),null===this.dragTarget)return;t.dispatch(b.body.attachImage(this.dragTarget,(0,m.default)(e.currentTarget).data("image"))),this.dragPosition=[]}}},{key:"render",value:function(){var e=this,t=this.props;return d.default.createElement("aside",{className:"ple-side"},d.default.createElement("div",{className:(0,g.default)("ple-side__wrap",{"ple-side__wrap-show":t.tree.side.visible})},d.default.createElement("span",{onClick:function(){return t.api.side.toggleSelectAll(!1)},className:"ple-side__background"}),d.default.createElement(E.default,{show:t.tree.side.visible,onClick:function(){return t.api.util.toggleSide(void 0)}}),d.default.createElement(k.default,{onAttach:function(){return e._attach()},onToggleSelect:function(){return t.api.side.toggleSelectAll()},onUpload:function(t){return e._upload(t)},onRemove:function(){return e._removeItems()}}),d.default.createElement(S.default,{files:t.tree.side.files,onSelect:function(t){return e._selectItem(t)},onDragStart:function(t){return e._dragStartItem(t)},onDragEnd:function(t){return e._dragEndItem(t)},onTouchStart:function(t){return e._touchStartItem(t)},onTouchMove:function(t){return e._touchMoveItem(t)},onTouchEnd:function(t){return e._touchEndItem(t)},progress:t.tree.side.progressPercent})))}}]),t}(d.default.Component),u.displayName="Side",u.defaultProps={tree:{},setting:{},api:{},dispatch:null},c);t.default=(0,p.connect)(function(e){return Object.assign({},e)})(T)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,u,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),f=r(s),d=n(1),p=r(d),h=(u=l=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),c(t,[{key:"render",value:function(){var e=this.props;return f.default.createElement("button",{type:"button",onClick:e.onClick,className:"ple-side__toggle"},f.default.createElement("span",null,f.default.createElement("i",{className:(0,p.default)("ple-sp-ico","ple-abs",{"ple-ico-arrow-right":e.show,"ple-ico-arrow-left":!e.show})},"Toggle sidebar")))}}]),t}(s.Component),l.displayName="ToggleSideButton",l.defaultProps={show:!1,onClick:function(){}},u);t.default=h},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,l,u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(0),s=function(e){return e&&e.__esModule?e:{default:e}}(c),f=(l=a=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={timestamp:Date.now()},n}return i(t,e),u(t,[{key:"upload",value:function(e){this.props.onUpload(e.target.files),this.setState({timestamp:Date.now()})}},{key:"render",value:function(){var e=this,t=this.props,n=this.state;return s.default.createElement("nav",{className:"ple-sideNavigation ple-side__navigation"},s.default.createElement("div",{className:"ple-sideNavigation__wrap"},s.default.createElement("button",{type:"button",title:"attach images",onClick:t.onAttach},s.default.createElement("i",{className:"ple-sp-ico ple-ico-reply ple-abs"},"Moving the image to grid block")),s.default.createElement("button",{type:"button",title:"toggle select",onClick:t.onToggleSelect},s.default.createElement("i",{className:"ple-sp-ico ple-ico-select ple-abs"},"Toggle all select")),s.default.createElement("span",{title:"upload images",key:n.timestamp},s.default.createElement("input",{type:"file",ref:"inputFile",onChange:function(t){return e.upload(t)},multiple:!0}),s.default.createElement("i",{className:"ple-sp-ico ple-ico-upload ple-abs"},"upload images")),s.default.createElement("button",{type:"button",title:"remove images",onClick:t.onRemove},s.default.createElement("i",{className:"ple-sp-ico ple-ico-trash ple-abs"},"remove images"))))}}]),t}(s.default.Component),a.displayName="Navigation",a.defaultProps={onRemove:function(){},onToggleSelect:function(){},onAttach:function(){},onUpload:function(){}},l);t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,u,c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(0),f=r(s),d=n(93),p=r(d),h=(u=l=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),c(t,[{key:"render",value:function(){var e=this.props;return f.default.createElement("div",{className:"ple-sideItems"},f.default.createElement("div",{className:"ple-sideItems__wrap"},f.default.createElement("ul",null,Object.keys(e.files).map(function(t){return f.default.createElement(p.default,{key:t,id:t,image:e.files[t].image,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd,onClick:function(){return e.onSelect(parseInt(t))},active:e.files[t].active})}),null!==e.progress&&f.default.createElement("li",{className:"ple-sideItems__loading"},f.default.createElement("div",{className:"ple-sideItems__progress"},f.default.createElement("span",{className:"ple-sideItems__bar",style:{height:e.progress+"%"}}),f.default.createElement("span",{className:"ple-sideItems__percent"},e.progress+"%"))))))}}]),t}(f.default.Component),l.displayName="Items",l.defaultProps={files:[],onSelect:function(e){},onDragStart:null,onDragEnd:null,onTouchStart:null,onTouchMove:null,onTouchEnd:null,progress:null},u);t.default=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l,u,c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(0),d=r(f),p=n(1),h=r(p),g=n(2),v=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(g),m=(u=l=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=Object.assign({},v.util.isTouchDevice()?{onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd}:{onDragStart:e.onDragStart,onDragEnd:e.onDragEnd});return d.default.createElement("li",null,d.default.createElement("span",c({type:"button","data-id":e.id,"data-image":e.image,draggable:!0,onClick:e.onClick},t,{style:{backgroundImage:"url('"+e.image+"')"},className:(0,h.default)({"ple-sideItems__item-active":e.active})})))}}]),t}(d.default.Component),l.displayName="Item",l.defaultProps={image:null,id:null,active:null,onClick:null,onDragStart:null,onDragEnd:null,onTouchStart:null,onTouchMove:null,onTouchEnd:null},u);t.default=m},function(e,t,n){"use strict";function r(e,t,n,r,o){switch(o){case"add":return{key:e,active:e===r?!t.active:t.active};case"range":return n=n||0,n<r?{key:e,active:e>=n&&e<=r}:{key:e,active:e<=n&&e>=r}}return e===r?{key:e,active:!t.active}:{key:e,active:!1}}function o(e,t){var n=e.keyboard.keyName,o=e.tree.side.files,a=null,l=!1,u={};if("SHIFT"!==n){var c=null;Object.keys(e.tree.side.files).forEach(function(n){var r=e.tree.side.files[n];if(parseInt(n)===t)return c=r,!1}),(i=!0===c.active?null:t)||!0!==c.active||(i=c.key)}switch(n){case"CTRL":case"CMD":a="add";break;case"SHIFT":a="range"}return Object.keys(o).forEach(function(e){var n=r(parseInt(e),o[e],i,t,a);n.active&&(l=!0),u[e]=n}),l||(i=null),u}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=null},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0});var o=n(10),i=n(96),a=r(i),l=n(98),u=r(l),c=n(99),s=function(e){return e&&e.__esModule?e:{default:e}}(c),f=n(100),d=r(f);t.default=(0,o.combineReducers)({setting:a.setting,api:a.api,keyboard:a.keyboard,element:a.element,tree:(0,o.combineReducers)({side:s.default,body:(0,o.combineReducers)({setting:u.setting,grid:u.grid,activeBlock:u.activeBlock}),cropper:(0,o.combineReducers)({visible:d.visible,item:d.item,key:d.key})})})},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(Object.assign({},e),t.type){case s.INIT_PLE:return Object.assign({},{base:u({},h.setting.base,{uploadScript:t.preference.uploadScript||h.setting.base.uploadScript,uploadParamsConvertFunc:t.preference.uploadParamsConvertFunc||h.setting.base.uploadParamsConvertFunc,updateStoreFunc:t.preference.updateStoreFunc||h.setting.base.updateStoreFunc}),side:u({},h.setting.side,t.preference.side),body:u({},h.setting.body,t.preference.body)});default:return e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case s.INIT_PLE:return t.api;default:return e}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;switch(arguments[1].type){case s.INIT_PLE:return new d.default;default:return e}}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case s.INIT_PLE:return t.element;default:return e}}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.setting=o,t.api=i,t.keyboard=a,t.element=l;var c=n(4),s=r(c),f=n(97),d=function(e){return e&&e.__esModule?e:{default:e}}(f),p=n(15),h=r(p)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(5),a=function(e){return e&&e.__esModule?e:{default:e}}(i),l=n(2),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(l),c=function(){function e(){var t=this;r(this,e),this.eventName="PLE_"+u.number.getTimeStamp(),this.code=null,this.keyName=null,this.names={17:"CTRL",18:"ALT",91:"CMD",93:"CMD",16:"SHIFT"},(0,a.default)(window).on("keydown."+this.eventName,function(e){return t._keyDown(e)})}return o(e,[{key:"apply",value:function(e){this.code=e,this.keyName=this.names[this.code]||null}},{key:"_keyDown",value:function(e){var t=this;this.apply(e.keyCode),(0,a.default)(window).on("keyup."+this.eventName,function(){return t._keyUp()}).on("contextmenu."+this.eventName,function(){return t._keyUp()}).on("blur."+this.eventName,function(){return t._keyUp()}).off("keydown."+this.eventName)}},{key:"_keyUp",value:function(){var e=this;this.apply(null),(0,a.default)(window).on("keydown."+this.eventName,function(t){return e._keyDown(t)}).off("contextmenu."+this.eventName+" keyup."+this.eventName+" blur."+this.eventName)}},{key:"destroy",value:function(){(0,a.default)(window).off("keydown."+this.eventName+" contextmenu."+this.eventName+" keyup."+this.eventName+" blur."+this.eventName)}}]),e}();t.default=c},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h.setting.body.setting,t=arguments[1];switch(t.type){case s.INIT_PLE:try{return u({},e,t.preference.body.setting)}catch(t){return e}case s.GRID_SETTING_UPDATE:return u({},e,t.value)}return e}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=Object.assign({},e);switch(t.type){case s.INIT_PLE:var r={};try{if(t.preference.body.grid instanceof Array)t.preference.body.grid.forEach(function(e,t){r[t]=e});else{if("object"!==l(t.preference.body.grid))throw"error";r=t.preference.body.grid}Object.keys(r).forEach(function(e){n[g++]=u({color:h.setting.body.blockColor},r[e],{indexPrefix:v})})}catch(e){n={}}return n;case s.GRID_ADD_BLOCK:return n[g++]=u({color:h.setting.body.blockColor,layout:{x:1/0,y:1/0,w:1,h:1}},t.value,{indexPrefix:v}),n;case s.GRID_REMOVE_BLOCK:return t.keys&&t.keys.length?(t.keys.forEach(function(e){delete n[e]}),n):e;case s.GRID_SHUFFLE_BLOCKS:return Object.keys(n).map(function(e){return u({},n[e],{layout:{x:d.number.randomRange(0,t.value.x-1),y:d.number.randomRange(0,t.value.y-1),w:d.number.randomRange(1,t.value.w),h:d.number.randomRange(1,t.value.h)},indexPrefix:v++})});case s.GRID_DUPLICATE_BLOCK:return t.keys.forEach(function(e){n[e]&&(n[g++]=Object.assign({},n[e]))}),n;case s.GRID_CHANGE_COLOR:return t.keys.forEach(function(e){n[e]&&(n[e].color=t.color)}),n;case s.GRID_ATTACH_IMAGES:return d.object.isArray(t.value)?(t.activeBlocks&&t.activeBlocks.length?Object.keys(n).forEach(function(e){t.value.length&&-1!==t.activeBlocks.indexOf(e)&&(n[e].image={src:t.value.splice(0,1)[0],position:"50% 50%",size:"cover"})}):(Object.keys(n).forEach(function(e){n[e].image||t.value&&t.value.length&&(n[e].image={src:t.value.splice(0,1)[0],position:"50% 50%",size:"cover"})}),t.value.length&&t.value.forEach(function(r,o){n[g++]={color:h.setting.body.blockColor,layout:{x:(Object.keys(e).length+o)%t.columns,y:1/0,w:1,h:1},image:{src:r,position:"50% 50%",size:"cover"},indexPrefix:v}})),n):e;case s.GRID_ATTACH_IMAGE:return t.image&&"string"==typeof t.image&&n[t.keys]?(n[t.keys].image={src:t.image,position:"50% 50%",size:"cover"},n):e;case s.GRID_UPDATE_BLOCKS:return Object.assign({},e,t.value);case s.CROPPER_CLOSE:return n[t.key]?(t.position&&(n[t.key].image.position=t.position),t.size&&(n[t.key].image.size=t.size),n):e}return e}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],n=Object.assign([],e);switch(t.type){case s.GRID_ACTIVE_BLOCK:return t.value;case s.GRID_REMOVE_BLOCK:return t.keys&&t.keys.length?(t.keys.forEach(function(e){n.indexOf(e)<0||n.splice(n.indexOf(e),1)}),n):[]}return e}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.setting=o,t.grid=i,t.activeBlock=a;var c=n(4),s=r(c),f=n(2),d=r(f),p=n(15),h=r(p),g=0,v=0},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.side,t=arguments[1],n=Object.assign({},e),r={};switch(t.type){case l.INIT_PLE:try{return t.preference.side.files.forEach(function(e){r[s++]={image:e,active:!1}}),i({},e,t.preference.side,{files:i({},e.files,r)})}catch(t){return e}case l.SIDE_VISIBLE:return i({},e,{visible:t.value});case l.SIDE_TOGGLE:return i({},e,{visible:!e.visible});case l.SIDE_ADD_FILES:return t.files.forEach(function(e){r[s++]={image:e,active:!1}}),i({},n,{files:i({},n.files,r)});case l.SIDE_REMOVE_FILES:return t.keys.length?(t.keys.forEach(function(e){delete n.files[e]}),n):e;case l.SIDE_UPDATE_SELECTED:return t.value&&Object.keys(t.value).length?(Object.keys(t.value).forEach(function(e){n.files[e]&&(n.files[e].active=t.value[e].active)}),n):e;case l.SIDE_UPDATE_PROGRESS:return i({},e,{progressPercent:t.value});default:return e}}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=o;var a=n(4),l=r(a),u=n(15),c=r(u),s=0},function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];switch(arguments[1].type){case l.CROPPER_OPEN:return!0;case l.CROPPER_CLOSE:return!1;default:return e}}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case l.CROPPER_OPEN:return t.item;case l.CROPPER_CLOSE:return null;default:return e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[1];switch(t.type){case l.CROPPER_OPEN:return t.key;case l.CROPPER_CLOSE:return null;default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.visible=r,t.item=o,t.key=i;var a=n(4),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(a)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){this.side=new a.default(e),this.grid=new u.default(e),this.cropper=new s.default(e),this.util=new d.default(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=n(102),a=r(i),l=n(103),u=r(l),c=n(104),s=r(c),f=n(105),d=r(f)},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(6),l=r(a),u=n(2),c=r(u),s=function(){function e(t){o(this,e),this.store=t,this.uploading=!1}return i(e,[{key:"getKeys",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this.store.getState(),r=n.tree.side.files,o=[];switch(e){case"selected":Object.keys(r).forEach(function(e){r[e].active&&o.push(parseInt(e))});break;case"value":t.forEach(function(e){r[e]&&o.push(parseInt(e))});break;case"all":default:o=Object.keys(r).map(function(e){return parseInt(e)})}return o}},{key:"getItems",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.store.getState(),n=t.tree.side;e=this.getKeys("value",e);var r={};return e.forEach(function(e){n.files[e]&&(r[e]=n.files[e])}),r}},{key:"getImages",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.getItems(e);return Object.keys(t).map(function(e){return t[e].image})}},{key:"add",value:function(e){try{if(!(e instanceof Array))throw new Error("not found files");this.store.dispatch(l.side.addFiles(e))}catch(e){return e}}},{key:"selection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{var n={},r=this.getKeys("value",e);if(r.length<=0)throw new Error("not found select item");r.forEach(function(e){n[e]={key:e,active:t}}),this.store.dispatch(l.side.updateSelected(n))}catch(e){return e}}},{key:"select",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.store.dispatch(l.side.updateSelected(e))}},{key:"toggleSelectAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if("boolean"==typeof e){var t=this.getKeys("all");this.selection(t,e)}else{var n=this.getKeys("selected").length,r=this.getKeys("all");this.selection(r,!(n>0))}}},{key:"remove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];try{if(!e.length)throw new Error("Not found items.");this.store.dispatch(l.side.removeFiles(e))}catch(e){return e}}},{key:"clear",value:function(){var e=this.getKeys("all");this.store.dispatch(l.side.removeFiles(e))}},{key:"upload",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.uploading){var r=this.store.getState();this.uploading=!0,n.start&&n.start(),c.uploader(e,r.setting.base.uploadScript).progress(function(e,o){switch(e){case"start":t.store.dispatch(l.side.updateProgress(0));break;case"progress":var i=parseInt(o.loaded/o.total*100);t.store.dispatch(l.side.updateProgress(i)),n.progress&&n.progress(o.loaded,o.total,i);break;case"done":if(t.store.dispatch(l.side.updateProgress(null)),!o.data)return;if(r.setting.base.uploadParamsConvertFunc){var a=r.setting.base.uploadParamsConvertFunc(o.data);t.store.dispatch(l.side.addFiles([a]))}else t.store.dispatch(l.side.addFiles([o.data.url]));return void(n.complete&&n.complete(o.data))}}).done(function(){t.uploading=!1,n.completeAll&&n.completeAll()}).fail(function(e){t.uploading=!1,n.fail&&n.fail(e)})}}},{key:"attachToGrid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.store.getState(),n=t.tree.body;try{var r=this.getImages(e);if(!r.length)throw new Error("not found item.");this.store.dispatch(l.body.attachImages(r,n.setting.column,n.activeBlock))}catch(e){return e}}}]),e}();t.default=s},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(6),u=r(l),c=n(2),s=(r(c),function(){function e(t){o(this,e),this.store=t}return a(e,[{key:"getKeys",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this.store.getState(),r=n.tree.body,o=[];switch(e){case"selected":return r.activeBlock;case"value":return o=[],t.forEach(function(e){r.grid[e]&&o.push(e)}),o;case"all":default:return Object.keys(r.grid).map(function(e){return e})}}},{key:"getBlocks",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this.store.getState(),r=n.tree.body,o=[],i={};switch(e){case"selected":o=this.getKeys("selected");break;case"value":o=this.getKeys("value",t);break;case"all":default:return r.grid}return o.forEach(function(e){r.grid[e]&&(i[e]=r.grid[e])}),i}},{key:"shuffle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.store.getState(),n=t.tree.body,r={x:n.setting.column,y:2,w:2,h:2};e=Object.assign({},r,e),this.store.dispatch(u.body.shuffleBlocks(e))}},{key:"assignImages",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.store.getState(),n=t.tree.body;this.store.dispatch(u.body.attachImages(e,n.setting.column,n.activeBlock))}},{key:"assignImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null!==e&&null!==t&&this.store.dispatch(u.body.attachImage(e,t))}},{key:"removeImages",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.store.getState(),n=Object.assign({},t.tree.body.grid);e.forEach(function(e){n[e].image=null}),this.update(n)}},{key:"add",value:function(){function e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=Object.assign({},c,e),e.layout=Object.assign({},c.layout,e.layout),e.image=e.image?i({src:null,position:"50% 50%",size:"cover"},e.image):null,o(u.body.addBlock(e))}var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.store,r=n.getState,o=n.dispatch,a=r(),l=a.tree.body,c={layout:{x:Object.keys(l.grid).length%l.setting.column,y:1/0,w:1,h:1},color:null,image:null};t=t&&t.length?t:[null],t.forEach(function(t){return e(t)})}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.store.dispatch(u.body.updateBlocks(e))}},{key:"remove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.store.dispatch(u.body.removeBlock(e))}},{key:"select",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e=e.map(function(e){return e.toString()}),this.store.dispatch(u.body.activeBlock(e))}},{key:"unselect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.store.getState(),n=Object.assign([],t.tree.body.activeBlock);e.forEach(function(e){e=e.toString(),-1!==n.indexOf(e)&&n.splice(n.indexOf(e),1)}),this.store.dispatch(u.body.activeBlock(n))}},{key:"toggleSelectAll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.store.getState();"boolean"!=typeof e&&(e=!t.tree.body.activeBlock.length),e?this.select(this.getKeys("all")):this.select([])}},{key:"duplicate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.store.dispatch(u.body.duplicateBlock(e))}},{key:"getPreference",value:function(){return this.store.getState().tree.body.setting}},{key:"setPreference",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},this.getPreference(),e);this.store.dispatch(u.body.updateSetting(t))}}]),e}());t.default=s},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(6),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(i),l=function(){function e(t){r(this,e),this.store=t}return o(e,[{key:"open",value:function(e){var t=this.store.getState(),n=null;try{if(n=t.tree.body.grid[e],!n.image)throw"Not found image in item"}catch(e){return void alert(e)}this.store.dispatch(a.cropper.open(e,n))}},{key:"close",value:function(e,t,n){this.store.dispatch(a.cropper.close(e,t,n))}}]),e}();t.default=l},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(5),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=n(6),s=r(c),f=n(2),d=r(f),p=n(29),h=function(){function e(t){o(this,e),this.store=t}return a(e,[{key:"toggleSide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;try{var t=this.store.getState().tree.side.visible,n=void 0===e?!t:e;this.store.dispatch(s.side.visible(n))}catch(e){console.warn("Error action",e)}}},{key:"export",value:function(){function e(){var e=r.api.side.getKeys("all");return r.api.side.getImages(e)}function t(){var e=r.api.grid.getBlocks("all");return Object.keys(e).sort().map(function(t){return delete e[t].indexPrefix,e[t]})}var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!n)return null;var r=this.store.getState();switch(n){case"side":return e();case"grid":return t();case"preference":return r.api.grid.getPreference();case"all":return{side:e(),grid:t(),preference:function(){return r.api.grid.getPreference()}()}}return null}},{key:"import",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var n=this.store.getState();e.side&&(0,p.isArray)(e.side)&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&n.api.side.clear(),n.api.side.add(e)}(e.side),e.grid&&(0,p.isArray)(e.grid)&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t){var r=n.api.grid.getKeys("all");n.api.grid.remove(r)}n.api.grid.add(e)}(e.grid),e.preference&&"object"===i(e.preference)&&n.api.grid.setPreference(e.preference)}}},{key:"makeImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"jpg",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.75,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=u.default.Deferred(),i=this.store.getState(),a=i.tree.body,l=a.setting,c=a.grid;return d.makingImage(i.element.querySelector(".ple-grid"),{setting:l,grid:c},{format:e,quality:t,sampling:n,output:r}).done(function(e){o.resolve(e)}).progress(function(e,t,n){o.notify(e,t,n)}).fail(function(e){o.reject(e)}),o.promise()}}]),e}();t.default=h},function(e,t){}],[32])});